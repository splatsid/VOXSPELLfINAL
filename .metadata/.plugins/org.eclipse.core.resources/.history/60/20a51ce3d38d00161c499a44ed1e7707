package application;

import java.io.File;
import java.util.ArrayList;

import javafx.application.Application;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Control;
import javafx.scene.control.ListView;
import javafx.scene.control.Tab;
import javafx.scene.control.TabPane;
import javafx.scene.control.TextField;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.Pane;
import javafx.scene.layout.VBox;
import javafx.scene.text.Font;
import javafx.scene.text.FontWeight;
import javafx.scene.text.Text;
import javafx.scene.text.TextAlignment;
import javafx.stage.Stage;
import quiz.NewQuiz;
import quiz.Quiz;
import quiz.ReadNWrite;
import quiz.ReviewQuiz;

public class GUIManager extends Application {
	private Quiz quiz;
	private NewQuiz quiznew;
	private ArrayList<String> quizwords;
	// The main frame, stores the different tabs
	public void start(Stage primaryStage) {

		TabPane tabs = new TabPane();
		Tab tabNewQuiz = new Tab();
		tabNewQuiz.setText("New Spelling Quiz");
		tabNewQuiz.setContent(newQuiz());

		Tab tabStats = new Tab();
		tabStats.setText("Stats view");
		tabStats.setContent(statsView());

		Tab options = new Tab();
		options.setText("Configurations");
		options.setContent(options());

		tabs.getTabs().addAll(tabNewQuiz, tabStats, options);

		Scene scene = new Scene(tabs, 600, 400); // Manage scene size
		primaryStage.setTitle("VOXSPELL");
		primaryStage.setScene(scene);
		primaryStage.show();

	}





	// The new quiz tab controls the buttons and actions that are related to the
	// new quiz
	private Pane newQuiz() {

		final Text showWord = new Text("New spelling quiz");
		final TextField inputText;

		BorderPane quizBG = new BorderPane();
		quizBG.setPadding(new Insets(5, 10, 5, 5));

		HBox footer = new HBox(10);

		final Text count = new Text("Count");

		inputText = new TextField("");
		inputText.setAlignment(Pos.BOTTOM_LEFT);
		quizBG.setBottom(inputText);

		ObservableList<String> levels = 
				FXCollections.observableArrayList(
						"Level 1",
						"Level 2",
						"Level 3",
						"Level 4",
						"Level 5",
						"Level 6",
						"Level 7",
						"Level 8",
						"Level 9",
						"Level 10",
						"Level 11"

						);
		final ComboBox<String> combo = new ComboBox(levels);
		combo.setPromptText("Quiz Level");

		Button sbmt = new Button(); // The start quiz button
		sbmt.setText("Start Quiz");

		Button quizrev = new Button();// Review quiz button
		quizrev.setText("Review Quiz");

		HBox buttonz = new HBox(10); // Horizontal box that allows two buttons
		// to be placed on the same row
		buttonz.setAlignment(Pos.TOP_CENTER);
		buttonz.getChildren().addAll(sbmt, combo, quizrev);
		quizBG.setTop(buttonz);

		// The output that is shown in the center of the screen
		showWord.setFont(Font.font("Tahoma", FontWeight.NORMAL, 25));
		showWord.setTextAlignment(TextAlignment.CENTER);
		quizBG.setCenter(showWord);

		sbmt.setOnAction(new EventHandler<ActionEvent>(){

			@Override
			// When new quiz is pressed the words are loaded in and the first word is said
			public void handle(ActionEvent arg0) {
				File file = new File("NZCER-spelling-lists.txt");
				quiz = new NewQuiz(file,inputText);
				quiz.loadWords(combo.getValue());
				quizwords = new ArrayList<String>(quiz.giveWords());
				try {
					quiz.startspellingtest(quizwords);
		//			addrepeatwordbutton();				//ADD REPEAT WORD BUTTON!
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}

		});
		
		
		quizrev.setOnAction(new EventHandler<ActionEvent>(){

			@Override
			public void handle(ActionEvent arg0) {
				String level = combo.getValue();
				String[] split = level.split("\\s+");
				int letternum = Integer.parseInt(split[1]);
				File file = new File("reviewlevel"+letternum+".txt");
			if(file.length()==0){
				System.out.println("There are no words to review at this level");
				//MAYBE HAVE A JLABEL OR SOMETHING SAYING THIS!
			}else{
				ReviewQuiz rq = new ReviewQuiz(file, inputText);
				ArrayList<String> revwordsallforlevel = new ArrayList<String>();
				revwordsallforlevel = rq.getreviewwordsforlevel(letternum);
				int numrevwords = revwordsallforlevel.size();
				ArrayList<Integer> wordnumbers = new ArrayList<Integer>();
				ReadNWrite rnq = new ReadNWrite(file);
				wordnumbers = rnq.choosewords(revwordsallforlevel);
				
				//NEED TO FINISH OFF THIS LOGIC FOR BEGINNING!
				
				ReviewQuiz rq = new ReviewQuiz();
				rq.startreviewquiz(testwords,numrevwords);
				//add repeat word button.
			}
			}
			
			
		});

		return quizBG;
	}






	// Controls the stats view pane
	private Pane statsView() {
		BorderPane pane = new BorderPane();
		pane.setPadding(new Insets(20, 0, 20, 20));

		// List view to show the statistics of each word
		final ListView<String> listofStats = new ListView<>();
		listofStats.setMaxHeight(Control.USE_PREF_SIZE);
		listofStats.setMaxWidth(350);
		pane.setCenter(listofStats);

		// Buttons that calculate and clear stats
		Button calcStats = new Button("Calculate Statistics");
		ObservableList<String> levels = 
				FXCollections.observableArrayList(
						"Level 1",
						"Level 2",
						"Level 3",
						"Level 4",
						"Level 5",
						"Level 6",
						"Level 7",
						"Level 8",
						"Level 9",
						"Level 10",
						"Level 11"

						);
		final ComboBox<String> combo = new ComboBox(levels);
		combo.setPromptText("Level");

		// Vertical box so that buttons can be stored in the same column.
		VBox verticalBox = new VBox(10);
		verticalBox.setAlignment(Pos.CENTER);
		verticalBox.getChildren().addAll(calcStats,combo);
		pane.setLeft(verticalBox);

		return pane;
	}

	private Pane options(){
		BorderPane pane = new BorderPane();
		VBox configurations = new VBox(20);	

		ObservableList<String> levels = 
				FXCollections.observableArrayList(
						"Default",
						"American"
						);
		final ComboBox<String> combo = new ComboBox(levels);
		combo.setPromptText("Festival Voices");

		Button btn = new Button("Clear Statistics");

		configurations.getChildren().addAll(btn,combo);
		configurations.setAlignment(Pos.CENTER);
		pane.setCenter(configurations);

		return pane;
	}



	public static void main(String[] args) {
		launch(args);
	}

	
	//When the new quiz is loaded this repeat word button appears and it will repeat the word currently spelled if pressed
/*	public void addrepeatwordbutton(){
		Button repeatword = new Button("Repeat Word");
		buttonz.setAlignment(Pos.TOP_CENTER);
		buttonz.getChildren().addAll(sbmt, combo, quizrev,repeatword);
		quizBG.setTop(buttonz);


		repeatword.setOnAction(new EventHandler<ActionEvent>(){

			@Override
			
			public void handle(ActionEvent arg0) {
			
				try {
			
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}

		});
	
	}

*/

}